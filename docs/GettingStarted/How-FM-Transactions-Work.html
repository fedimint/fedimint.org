<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-GettingStarted/How-FM-Transactions-Work">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Fedimint RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Fedimint Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">How do Fedimint transactions work? | Fedimint</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://fedimint.org/docs/GettingStarted/How-FM-Transactions-Work"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How do Fedimint transactions work? | Fedimint"><meta data-rh="true" name="description" content="This guide has been developed as a community project and is a live document. We would appreciate any feedback you may have and you can submit edits, corrections and pull requests through the link at the bottom of each page. Let&#x27;s build the future of Bitcoin custody together!"><meta data-rh="true" property="og:description" content="This guide has been developed as a community project and is a live document. We would appreciate any feedback you may have and you can submit edits, corrections and pull requests through the link at the bottom of each page. Let&#x27;s build the future of Bitcoin custody together!"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://fedimint.org/docs/GettingStarted/How-FM-Transactions-Work"><link data-rh="true" rel="alternate" href="https://fedimint.org/docs/GettingStarted/How-FM-Transactions-Work" hreflang="en"><link data-rh="true" rel="alternate" href="https://fedimint.org/docs/GettingStarted/How-FM-Transactions-Work" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e6834384.css">
<link rel="preload" href="/assets/js/runtime~main.49b2b8f5.js" as="script">
<link rel="preload" href="/assets/js/main.06796a6c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Fedimint-Full.png" alt="Fedimint Full Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/Fedimint-Full.png" alt="Fedimint Full Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Fedimint</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://github.com/fedimint" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/primer">Primer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Primer&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/GettingStarted/Why-Fedimint">Why Fedimint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/GettingStarted/Who-are-the-fms">Who are the federations?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/GettingStarted/What-is-a-Fedimint">What is a Fedimint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/GettingStarted/TechCompontents">Core Technology Components</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/GettingStarted/How-FM-Transactions-Work">How do Fedimint transactions work?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/GettingStarted/Running-a-Fedimint">Running a Fedimint</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/trade-offs">Trade Offs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Trade Offs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/definitions--terms">Definitions &amp; Terms</a><button aria-label="Toggle the collapsible sidebar category &#x27;Definitions &amp; Terms&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/MiniMintDetails/MinimintDemo">Fedimint Details</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/frequently-asked-questions">Frequently Asked Questions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Frequently Asked Questions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/primer"><span itemprop="name">Primer</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">How do Fedimint transactions work?</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>How do Fedimint transactions work?</h1><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>This guide has been developed as a community project and is a live document. We would appreciate any feedback you may have and you can submit edits, corrections and pull requests through the link at the bottom of each page. Let&#x27;s build the future of Bitcoin custody together!</p></div></div><p>This is a set of simplified transactions flows to explain how transaction processing works inside the Fedimint, with integration to the wider lightning network and between different mints.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transactions-within-a-fedimint">Transactions within a Fedimint<a class="hash-link" href="#transactions-within-a-fedimint" title="Direct link to heading">​</a></h2><p>This represents how a transaction would settle entirely within the same Fedimint.</p><p><img loading="lazy" alt="IntramintPayments" src="/assets/images/fm-Pay-IntraMint.excalidraw-73e0eb064a53b79cdb3ad48568f9c1bf.png" width="1241" height="990" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1--the-invoice">Step 1 : The Invoice<a class="hash-link" href="#step-1--the-invoice" title="Direct link to heading">​</a></h3><p>An invoice (in the form of data) is passed from Bob&#x27;s wallet to Alice&#x27;s wallet asking for payment to be forwarded for 15,000 sats.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-share-the-notes">Step 2: Share the notes<a class="hash-link" href="#step-2-share-the-notes" title="Direct link to heading">​</a></h3><p>Alice&#x27;s wallet responds by checking the notes it holds and selecting eCash notes that total 15,000 sats in this case a 10k sats and a 5k sats eCash note.</p><p>It then forwards these notes to Bob&#x27;s wallet.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-settle-the-transaction-with-new-ecash-notes">Step 3: Settle the transaction with new eCash notes<a class="hash-link" href="#step-3-settle-the-transaction-with-new-ecash-notes" title="Direct link to heading">​</a></h3><p>Bob now has the eCash files and can redeem them from the Fedimint. However, there is a risk that Alice still has the eCash notes copied and could redeem them first. As such the payment is not yet settled.</p><p>To settle the payment Bob submits the eCash notes to the mint and instead of redeeming for bitcoin, asks to swap them out for fresh eCash notes, in this instance a 15,000 sats eCash note.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>During implementation it is suspected that users will not use &quot;pay me in the mint&quot; invoices and would instead always assume they are paying Lightning invoices.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transactions-from-fedimint-to-lightning">Transactions from Fedimint to Lightning<a class="hash-link" href="#transactions-from-fedimint-to-lightning" title="Direct link to heading">​</a></h2><p>In this case the payment is being sent from a Fedimint user to pay a lightning invoice.</p><p>This works by setting up a situation in which a lightning gateway provider is incentivised to pay the lightning invoice in <strong>sats</strong> in order to receive a <strong>hash pre-image</strong> that allows them to claim <strong>fm-sats</strong>.</p><p>We will unpack this below.</p><p><img loading="lazy" alt="Pay Fedimint to Lightning" src="/assets/images/fm-Pay-MintToLN.excalidraw-38d6de55f52da9c9a45563d4dce1e232.png" width="2001" height="1123" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-the-lightning-invoice">Step 1: The lightning invoice<a class="hash-link" href="#step-1-the-lightning-invoice" title="Direct link to heading">​</a></h3><p>A lightning merchant (or general recipient) generates a lightning invoice in this case for <strong><em>10,000 sats</em></strong>.</p><p>This is actually a <a href="https://www.youtube.com/watch?v=hs79R8kd_70&amp;t=62s" target="_blank" rel="noopener noreferrer">Hash Time Lock Contract (HTLC)</a> contract that will provide some secret information - &quot;<strong>a hash pre-image</strong>&quot; in return for a payment in satoshis.</p><p>The merchant is in effect <strong>&quot;selling a pre-image-A&quot;</strong> for sats.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-create-the-incentive-to-pay">Step 2: Create the incentive to pay<a class="hash-link" href="#step-2-create-the-incentive-to-pay" title="Direct link to heading">​</a></h3><p>Alice would like to pay this invoice from her Fedimint wallet, but doesn&#x27;t run a lightning wallet herself.</p><p>Instead she creates an equivalent <a href="https://www.youtube.com/watch?v=hs79R8kd_70&amp;t=62s" target="_blank" rel="noopener noreferrer">Hash Time Lock Contract (HTLC)</a> that will pay out <strong><em>10,200 fm-sats</em></strong> to anyone who can supply a pre-image to the contract where the extra <strong><em>200 fm-sats</em></strong> represent a fee for the service.</p><p>An important note is that the <strong>hash</strong> used in this contract is the same <strong>hash</strong> used in the contract by the merchant linking the contracts together.</p><p>Here Alice is in effect willing to <strong>&quot;buy pre-image-A&quot;</strong> for sats+200.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-broadcast-to-lightning-gateways">Step 3: Broadcast to Lightning Gateways<a class="hash-link" href="#step-3-broadcast-to-lightning-gateways" title="Direct link to heading">​</a></h3><p>The Lightning Gateway, is now incentivized by this arbitrage opportunity to pay this invoice and obtain the pre-image in order to obtain fm-sats plus fee.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>There is a process by which the Lightning Gateway needs to become aware of the contract which could either be by direct contact from the user, or by the mint broadcasting available contracts. Yet to be fully defined.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-lightning-gateway-pays-the-invoice">Step 4: Lightning Gateway Pays the Invoice<a class="hash-link" href="#step-4-lightning-gateway-pays-the-invoice" title="Direct link to heading">​</a></h3><p>The Lightning Gateway routes a payment, through the lightning network to the merchant paying the invoice and obtaining the pre-image.</p><p>The &quot;lightning&quot; balance of the Lightning Gateway is now reduced by 10,000 sats.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-lightning-gateway-settles-the-mint-contract">Step 5: Lightning Gateway settles the mint contract<a class="hash-link" href="#step-5-lightning-gateway-settles-the-mint-contract" title="Direct link to heading">​</a></h3><p>The Lightning Gateway now takes that pre-image and uses this to claim the 10,200 fm-sats.</p><p>The Lightning Gateway&#x27;s fm-BTC balance is now up 10,200 sats and their net position is up 200 sats.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>By linking the HTLCs with the same pre-image between the lightning route and the mint, this allows the Fedimint to spoof a lightning node and extend the route &quot;into the mint&quot;.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="transactions-from-fedimint-to-other-fedimints">Transactions from Fedimint to Other Fedimints<a class="hash-link" href="#transactions-from-fedimint-to-other-fedimints" title="Direct link to heading">​</a></h2><p>This transaction represents a payment from a Fedimint to a Fedimint. As a payment between FMs is routed over the lightning network we can also imply in the same use case, how a lightning node to Fedimint payment would be completed.</p><p>In this instance Alice (in Fedimint 1) will receive a payment of 10,000 sats from Bob (in Fedimint 2).</p><p><img loading="lazy" alt="Pay Fedimint to Fedimint" src="/assets/images/fm-Pay-MintToMint.excalidraw-2f210868110262436f6af6a653aa7d36.png" width="2043" height="1282" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-alice-sells-a-pre-image">Step 1: Alice sells a pre-image<a class="hash-link" href="#step-1-alice-sells-a-pre-image" title="Direct link to heading">​</a></h3><p>Alice want&#x27;s to receive 10,000 sats, but her wallet doesn&#x27;t have a lightning node.</p><p>Instead her wallet creates a contract in Fedimint 1 which will sell the pre-image to a hash for 9,800 fm-sats, we&#x27;ll call this <strong><em>&quot;pre-image-A&quot;</em></strong>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-alice-lets-bob-know-how-to-pay">Step 2: Alice lets Bob know how to pay<a class="hash-link" href="#step-2-alice-lets-bob-know-how-to-pay" title="Direct link to heading">​</a></h3><p>Alice now sends Bob a Lightning invoice for 10,000 sats which includes two pieces of important information:</p><ul><li>a fake endpoint ID associated with Fedimint 1.</li><li>a route hint to Lightning Gateway A</li></ul><p>This provides Bob with the information required to pay this invoice over lightning.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-bob-buys-a-pre-image">Step 3: Bob buys a pre-image<a class="hash-link" href="#step-3-bob-buys-a-pre-image" title="Direct link to heading">​</a></h3><p>Bob would love to pay the 10,000 sats, but his wallet doesn&#x27;t have a lightning node.</p><p>Instead he follows the previous payment flow and posts a contract to Fedimint 2 that will pay 10,200 fm-sats to buy <strong><em>&quot;pre-image-A&quot;</em></strong> and lets Lightning Gateway B know about it, by providing the invoice with the route hint to Lightning Gateway A.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-lightning-gateway-b-pays-lightning-gateway-a">Step 4: Lightning Gateway B pays Lightning Gateway A<a class="hash-link" href="#step-4-lightning-gateway-b-pays-lightning-gateway-a" title="Direct link to heading">​</a></h3><p>Lighting Gateway B routes 10,000 sats over the lightning network to Lightning Gateway A seeking a pre-image!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-lightning-gateway-a-settles-in-fedimint-1">Step 5: Lightning Gateway A settles in Fedimint 1<a class="hash-link" href="#step-5-lightning-gateway-a-settles-in-fedimint-1" title="Direct link to heading">​</a></h3><p>Luckily Lightning Gateway A realizes that he can obtain this pre-image and get paid a 200 fm-sats difference by paying 9,800 fm-sats to the contract (which then goes to Alice).</p><p>Now Lightning Gateway A has the pre-image.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-lightning-gateway-a-settles-with-lightning-gateway-b">Step 6: Lightning Gateway A settles with Lightning Gateway B<a class="hash-link" href="#step-6-lightning-gateway-a-settles-with-lightning-gateway-b" title="Direct link to heading">​</a></h3><p>LN Gateway A takes the pre-image and uses it to settle the payment with Lightning Gateway B and now receives sats to it&#x27;s lightning balance sheet.</p><p>The final balance sheet standing for Lightning Gateway A is:</p><ul><li>fm-sats: -9,800</li><li>LN sats: +10,000</li><li>Net: +200 sats</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-7-lightning-gateway-b-settles-in-fedimint-2">Step 7: Lightning Gateway B settles in Fedimint 2<a class="hash-link" href="#step-7-lightning-gateway-b-settles-in-fedimint-2" title="Direct link to heading">​</a></h3><p>Having the pre-image lightning gateway B now settles the contract held in Fedimint 2, receiving fm-sats for this from Bob.</p><p>The final balance sheet for Lightning Gateway B is:</p><ul><li>fm-sats: +10,200</li><li>LN sats: -10,000</li><li>Net: +200 sats</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pay-lightning-into-a-fedimint">Pay Lightning into a Fedimint<a class="hash-link" href="#pay-lightning-into-a-fedimint" title="Direct link to heading">​</a></h2><p>The process by which you would make a payment from a lightning wallet into a Fedimint wallet is a simplified case of paying from Mint 2 to Mint 1.</p><p>If Bob had a lightning wallet, instead of &quot;buying a pre-image&quot; in step 3, he would have skipped directly to step 4 and paid Lightning Gateway A himself.</p><p>There would also have been no requirement for step 7.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lightning-routing">Lightning Routing<a class="hash-link" href="#lightning-routing" title="Direct link to heading">​</a></h3><p>You may be wondering - hang on, if I can receive lightning payments and send lightning payments, does that mean I can route lightning payments?</p><p>The answer is yes, sort of.</p><p>This will be explored more in the FAQs as it has some interesting implications for privacy and computational use cases.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/fedimint/wiki_fedimint/tree/main/docs/GettingStarted/05-How-FM-Transactions-Work.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/GettingStarted/TechCompontents"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Core Technology Components</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/GettingStarted/Running-a-Fedimint"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Running a Fedimint</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#transactions-within-a-fedimint" class="table-of-contents__link toc-highlight">Transactions within a Fedimint</a><ul><li><a href="#step-1--the-invoice" class="table-of-contents__link toc-highlight">Step 1 : The Invoice</a></li><li><a href="#step-2-share-the-notes" class="table-of-contents__link toc-highlight">Step 2: Share the notes</a></li><li><a href="#step-3-settle-the-transaction-with-new-ecash-notes" class="table-of-contents__link toc-highlight">Step 3: Settle the transaction with new eCash notes</a></li></ul></li><li><a href="#transactions-from-fedimint-to-lightning" class="table-of-contents__link toc-highlight">Transactions from Fedimint to Lightning</a><ul><li><a href="#step-1-the-lightning-invoice" class="table-of-contents__link toc-highlight">Step 1: The lightning invoice</a></li><li><a href="#step-2-create-the-incentive-to-pay" class="table-of-contents__link toc-highlight">Step 2: Create the incentive to pay</a></li><li><a href="#step-3-broadcast-to-lightning-gateways" class="table-of-contents__link toc-highlight">Step 3: Broadcast to Lightning Gateways</a></li><li><a href="#step-4-lightning-gateway-pays-the-invoice" class="table-of-contents__link toc-highlight">Step 4: Lightning Gateway Pays the Invoice</a></li><li><a href="#step-5-lightning-gateway-settles-the-mint-contract" class="table-of-contents__link toc-highlight">Step 5: Lightning Gateway settles the mint contract</a></li></ul></li><li><a href="#transactions-from-fedimint-to-other-fedimints" class="table-of-contents__link toc-highlight">Transactions from Fedimint to Other Fedimints</a><ul><li><a href="#step-1-alice-sells-a-pre-image" class="table-of-contents__link toc-highlight">Step 1: Alice sells a pre-image</a></li><li><a href="#step-2-alice-lets-bob-know-how-to-pay" class="table-of-contents__link toc-highlight">Step 2: Alice lets Bob know how to pay</a></li><li><a href="#step-3-bob-buys-a-pre-image" class="table-of-contents__link toc-highlight">Step 3: Bob buys a pre-image</a></li><li><a href="#step-4-lightning-gateway-b-pays-lightning-gateway-a" class="table-of-contents__link toc-highlight">Step 4: Lightning Gateway B pays Lightning Gateway A</a></li><li><a href="#step-5-lightning-gateway-a-settles-in-fedimint-1" class="table-of-contents__link toc-highlight">Step 5: Lightning Gateway A settles in Fedimint 1</a></li><li><a href="#step-6-lightning-gateway-a-settles-with-lightning-gateway-b" class="table-of-contents__link toc-highlight">Step 6: Lightning Gateway A settles with Lightning Gateway B</a></li><li><a href="#step-7-lightning-gateway-b-settles-in-fedimint-2" class="table-of-contents__link toc-highlight">Step 7: Lightning Gateway B settles in Fedimint 2</a></li></ul></li><li><a href="#pay-lightning-into-a-fedimint" class="table-of-contents__link toc-highlight">Pay Lightning into a Fedimint</a><ul><li><a href="#lightning-routing" class="table-of-contents__link toc-highlight">Lightning Routing</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Wiki</a></li><li class="footer__item"><a href="https://web.fedimint.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">WebSDK</a></li><li class="footer__item"><a href="https://docs.fedimint.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rust Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://primal.net/p/nprofile1qqsgwgkrss7gthwkzc49edgxu895664setaevcp57snw2k3wlzdrghswflshg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Nostr<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/fedimint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.fedimint.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/fedimint" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Contribute</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/fedimint" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Contact</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:elsirion@protonmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mail<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fedimint.org/elsirion.asc" target="_blank" rel="noopener noreferrer" class="footer__link-item">GPG Key<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/assets/js/runtime~main.49b2b8f5.js"></script>
<script src="/assets/js/main.06796a6c.js"></script>
</body>
</html>